{% extends "admin/base.html" %}
{% block title %}Admin · Articole{% endblock %}
{% block content %}
  <div class="card">
    <div class="toolbar">
      <form action="/admin" method="get">
        <input type="text" name="q" value="{{ q }}" placeholder="Caută titlu sau rezumat…" />
        <select name="category">
          {% for c in categories %}
            <option value="{{ c }}" {% if c == category %}selected{% endif %}>{{ c }}</option>
          {% endfor %}
        </select>
        <button type="submit">Caută</button>
        <a class="btn" href="/admin/new">Adaugă articol</a>
      </form>
    </div>
    <table>
      <thead>
        <tr>
          <th style="width:28%">Titlu</th>
          <th style="width:36%">Rezumat</th>
          <th>Sursă</th>
          <th>Categorie</th>
          <th>Publicat</th>
          <th style="width:160px"></th>
        </tr>
      </thead>
      <tbody>
        {% for a in articles %}
          <tr>
            <td>{{ a.title }}</td>
            <td class="muted">{{ a.summary }}</td>
            <td>{{ a.source }}</td>
            <td>{{ a.category }}</td>
            <td class="muted">{{ a.published_at }}</td>
            <td>
              <div class="row-actions">
                <a class="btn" href="/admin/{{ a.id }}/edit">Editează</a>
                <form action="/admin/{{ a.id }}/delete" method="post" onsubmit="return confirm('Ștergi articolul?')">
                  <button class="secondary" type="submit">Șterge</button>
                </form>
              </div>
            </td>
          </tr>
        {% endfor %}
        {% if not articles %}
          <tr><td colspan="6" class="muted" style="padding:24px">Nu sunt articole.</td></tr>
        {% endif %}
      </tbody>
    </table>
    <div class="footer">
      {% set total_pages = (total // page_size) + (1 if total % page_size > 0 else 0) %}
      <div class="muted">Total: {{ total }}</div>
      <div>
        {% if page > 1 %}
          <a class="pill" href="/admin?q={{ q }}&category={{ category }}&page={{ page - 1 }}">Prev</a>
        {% endif %}
        <span class="pill">Pagina {{ page }} / {{ total_pages or 1 }}</span>
        {% if page < total_pages %}
          <a class="pill" href="/admin?q={{ q }}&category={{ category }}&page={{ page + 1 }}">Next</a>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}


